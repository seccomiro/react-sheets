(this.webpackJsonpsheets=this.webpackJsonpsheets||[]).push([[0],{36:function(e,t,n){e.exports=n(47)},47:function(e,t,n){"use strict";n.r(t);var l=n(0),a=n.n(l),r=n(16),s=n.n(r),c=n(12),u=n(51),o=n(7),i=n(8),m=n(18),h=n(19),p=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(o.a)(this,n);for(var l=arguments.length,a=new Array(l),r=0;r<l;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.props.updateEditingCell(t.target.value)},e.onSelectCell=function(t){e.props.selectCell(e.props.name,!0)},e.onKeyDown=function(t){9===t.which?e.nextElement("Column",t):13===t.which&&e.nextElement("Row",t)},e.nextElement=function(t,n){n.preventDefault(),e.props.updateCell(e.props.name,n.target.value),e.props["next".concat(t)]()},e.onBlur=function(t){e.props.updateCell(e.props.name,t.target.value)},e}return Object(i.a)(n,[{key:"render",value:function(){return this.props.selectedCell&&this.props.selectedCell.name===this.props.name?a.a.createElement("div",{className:"cell selected"},a.a.createElement("input",{className:"test",onKeyDown:this.onKeyDown,onChange:this.onChange,onFocus:function(e){return e.target.select()},onBlur:this.onBlur,type:"text",value:this.props.selectedCell.tempFormula,autoFocus:!0})):a.a.createElement("div",{className:"cell",onClick:this.onSelectCell},a.a.createElement("div",{className:"test"},this.props.cell.value||"\xa0"))}}]),n}(a.a.Component),d=Object(c.b)((function(e,t){var n=e.sheet.sheet.findCell(t.name);return{selectedCell:e.sheet.selectedCell,cell:n}}),{updateCell:function(e,t){return{type:"UPDATE_CELL",payload:{cellName:e,formula:t}}},updateEditingCell:function(e){return{type:"UPDATE_EDITING_CELL",payload:e}},selectCell:function(e,t){return{type:"SELECT_CELL",payload:{name:e,selected:t}}},nextColumn:function(){return{type:"NEXT_COLUMN"}},nextRow:function(){return{type:"NEXT_ROW"}}})(p),f=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],v=function(e){return f[e]},C=function(e){return e+1},E=function(e,t){return"".concat(v(t)).concat(C(e))},y=function(e){return{row:(n=e[1],parseInt(n)-1),column:(t=e[0],f.indexOf(t.toUpperCase()))};var t,n},O=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(i.a)(n,[{key:"renderCells",value:function(){var e=this;return a.a.createElement("table",{className:"sheet-table"},a.a.createElement("thead",{style:{textAlign:"right"}},a.a.createElement("tr",null,a.a.createElement("th",{className:"column-header"}),this.props.cells[0].map((function(t,n){var l,r,s;return a.a.createElement("th",{key:"c".concat(n),className:"column-header ".concat((r=null===(l=e.props.selectedCell)||void 0===l?void 0:l.name,s=t.getName(),r&&s&&y(r).column===y(s).column?"selected":""))},a.a.createElement("div",null,v(n)))})))),a.a.createElement("tbody",null,this.props.cells.map((function(t,n){return a.a.createElement("tr",{key:n},t.map((function(t,r){var s,c,u,o;return a.a.createElement(l.Fragment,{key:r},0===r?a.a.createElement("th",{className:"row-header ".concat((u=null===(s=e.props.selectedCell)||void 0===s?void 0:s.name,o=t.getName(),u&&o&&y(u).row===y(o).row?"selected":""))},a.a.createElement("div",null,C(n))):a.a.createElement(a.a.Fragment,null),a.a.createElement("td",{className:(null===(c=e.props.selectedCell)||void 0===c?void 0:c.name)===t.getName()?"selected":""},a.a.createElement(d,{name:t.getName()})))})))}))))}},{key:"render",value:function(){return a.a.createElement("div",null,this.renderCells())}}]),n}(a.a.Component),b=Object(c.b)((function(e){return{cells:e.sheet.sheet.cells,selectedCell:e.sheet.selectedCell}}),{})(O),w=n(6),N=Object(w.a)(),g=function(){return a.a.createElement("div",null,a.a.createElement(u.b,{history:N},a.a.createElement(u.c,null,a.a.createElement(u.a,{path:"/",exact:!0,component:b}))))},j=n(9),k=n(30),L=n(13),_=n(31),x=n.n(_),T=n(34),D=n(50),F=/([+,*,/,=,\-,(,)])/g,S=function(e){return!U(e)&&""!==e&&"="!==e&&!e.match(F)},U=function(e){return!isNaN(e)},P=function(){function e(t){var n=t.sheet,l=t.formula,a=void 0===l?"0":l,r=t.value,s=void 0===r?"0":r;Object(o.a)(this,e),this.sheet=n,this.formula=a,this.value=s,this.listeners=new Set,this.pointedCells={}}return Object(i.a)(e,[{key:"setFormula",value:function(e){this.formula=e;var t=function(e){var t=e.split(F).filter((function(e){return S(e.trim())}));return Object(T.a)(new Set(t))}(e);this.pointedCells=this.sheet.register(this,t),this.evaluate()}},{key:"registerListener",value:function(e){this.listeners.add(e)}},{key:"getName",value:function(){return this.sheet.getCellName(this)}},{key:"evaluate",value:function(){var e,t;this.formula.startsWith("=")?this.value=(e=this.formula.substring(1,this.formula.length),t=this.pointedCellParams(),Object(D.a)(e,t)):this.value=this.formula,this.listeners.forEach((function(e){return e.evaluate()}))}},{key:"pointedCellParams",value:function(){var e=this,t={};return Object.keys(this.pointedCells).forEach((function(n){return t[n]=e.pointedCells[n].value})),t}}]),e}(),R={sheet:new(function(){function e(t){var n=t.rows,l=t.columns,a=t.name;Object(o.a)(this,e),this.cellNames=new Map,this.cells=this.createCells(n,l),this.name=a}return Object(i.a)(e,[{key:"register",value:function(e,t){var n=this;return t.map((function(e){return n.findCell(e)})).forEach((function(t){return t.registerListener(e)})),this.cellMap(t)}},{key:"cellMap",value:function(e){var t=this,n={};return e.forEach((function(e){var l=t.findCell(e);n[e]=l})),n}},{key:"findCell",value:function(e){var t=y(e);return this.cells[t.row][t.column]}},{key:"updateCell",value:function(e,t){this.findCell(e).setFormula(t)}},{key:"createCells",value:function(e,t){for(var n=[],l=0;l<e;l++){n[l]=[];for(var a=0;a<t;a++){var r=new P({sheet:this,formula:"",value:""});n[l][a]=r,this.cellNames.set(r,E(l,a))}}return n}},{key:"getCellName",value:function(e){return this.cellNames.get(e)}},{key:"size",value:function(){return{rows:this.rows(),columns:this.columns()}}},{key:"rows",value:function(){return this.cells.length}},{key:"columns",value:function(){return this.cells[0].length}},{key:"nextRow",value:function(e){var t=y(e),n=t.row===this.rows()-1?0:t.row+1;return E(n,t.column)}},{key:"nextColumn",value:function(e){var t=y(e),n=t.column===this.columns()-1?0:t.column+1;return E(t.row,n)}}]),e}())({rows:9,columns:26,name:"Sheet 1"}),selectedCell:void 0},A=Object(j.c)({sheet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_EDITING_CELL":return x()(e,{selectedCell:{tempFormula:{$set:t.payload.toUpperCase()}}});case"UPDATE_CELL":var n=t.payload,l=n.cellName,a=n.formula;return e.sheet.updateCell(l,a),e;case"SELECT_CELL":return Object(L.a)({},e,{selectedCell:t.payload.selected?{name:t.payload.name,tempFormula:e.sheet.findCell(t.payload.name).formula}:void 0});case"NEXT_COLUMN":var r=e.sheet.nextColumn(e.selectedCell.name),s=e.sheet.findCell(r).formula;return Object(L.a)({},e,{selectedCell:Object(L.a)({},e.selectedCell,{name:r,tempFormula:s})});case"NEXT_ROW":var c=e.sheet.nextRow(e.selectedCell.name),u=e.sheet.findCell(c).formula;return Object(L.a)({},e,{selectedCell:Object(L.a)({},e.selectedCell,{name:c,tempFormula:u})});default:return e}}}),I=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||j.d,M=Object(j.e)(A,I(Object(j.a)(k.a)));s.a.render(a.a.createElement(c.a,{store:M},a.a.createElement(g,null)),document.querySelector("#root"))}},[[36,1,2]]]);
//# sourceMappingURL=main.3649d540.chunk.js.map