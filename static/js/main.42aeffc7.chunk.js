(this["webpackJsonpreact-sheets"]=this["webpackJsonpreact-sheets"]||[]).push([[0],{42:function(e,t,l){e.exports=l(56)},56:function(e,t,l){"use strict";l.r(t);var n,a=l(0),r=l.n(a),o=l(21),c=l.n(o),s=l(12),i=l(36),u=l(16),m=l(8),h=l(9),d=l(13),p=l(14),f=function(e,t){return{type:"UPDATE_CELL",payload:{cellName:e,formula:t}}},v=function(e){return{type:"UPDATE_EDITING_CELL",payload:e}},E=function(e,t){var l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return{type:"SELECT_CELL",payload:{name:e,selected:t,options:l}}},C=function(){return{type:"NEXT_ROW"}},g=function(){return{type:"NEXT_COLUMN"}},y=function(){return{type:"PREVIOUS_ROW"}},w=function(){return{type:"PREVIOUS_COLUMN"}},b=function(e){Object(p.a)(l,e);var t=Object(d.a)(l);function l(){var e;Object(m.a)(this,l);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.props.updateEditingCell(t.target.value)},e.onKeyDown=function(t){9===t.which?e.nextElement("Column",t,!1,!0):13===t.which?e.nextElement("Row",t,!1,!0):27===t.which&&e.props.selectCell(e.props.name,!0)},e.nextElement=function(t,l){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];l.preventDefault();var r=n?"previous":"next";a&&e.props.updateCell(e.props.name,l.target.value),e.props["".concat(r).concat(t)]()},e.onFocus=function(){e.props.atFormulaBar&&e.props.selectFormulaBar(!0)},e.onBlur=function(t){e.props.atFormulaBar&&e.props.selectFormulaBar(!1),e.props.updateCell(e.props.name,t.target.value)},e}return Object(h.a)(l,[{key:"render",value:function(){return r.a.createElement("input",{onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onChange:this.onChange,type:"text",value:this.props.formula,autoFocus:!this.props.formulaBarSelected})}}]),l}(a.Component),O=Object(s.b)((function(e){return{formula:e.sheet.selectedCell.tempFormula,name:e.sheet.selectedCell.name,formulaBarSelected:e.sheet.selectedCell.formulaBarSelected}}),{updateEditingCell:v,updateCell:f,nextColumn:g,nextRow:C,previousColumn:w,previousRow:y,selectFormulaBar:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{type:"SELECT_FORMULA_BAR",payload:{entering:e}}},selectCell:E})(b),N=function(e){Object(p.a)(l,e);var t=Object(d.a)(l);function l(){var e;Object(m.a)(this,l);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).focusSelecTed=function(){e.field&&!e.props.selectedCell.formulaBarSelected&&e.field.focus()},e.onEditCell=function(t){e.props.editCell(e.props.name,!0)},e.onSelectCell=function(t){e.props.selectCell(e.props.name,!0,{shift:!!t.shiftKey,ctrl:!!t.ctrlKey})},e.onEditingKeyDown=function(t){13===t.which?e.nextElement("Row",t,!1,!0):37===t.which?e.nextElement("Column",t,!0,!0):38===t.which?e.nextElement("Row",t,!0,!0):39===t.which?e.nextElement("Column",t,!1,!0):40===t.which&&e.nextElement("Row",t,!1,!0)},e.onSelectedKeyDown=function(t){113===t.which||13===t.which?(t.preventDefault(),e.props.editCell(e.props.name,!0)):9===t.which?e.nextElement("Column",t):37===t.which?e.nextElement("Column",t,!0):38===t.which?e.nextElement("Row",t,!0):39===t.which?e.nextElement("Column",t):40===t.which?e.nextElement("Row",t):46===t.which?e.props.deleteCellContents():e.printableKey(t.which)&&(t.preventDefault(),e.props.editCell(e.props.name,!0,e.printableKey(t.which)))},e.nextElement=function(t,l){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];l.preventDefault();var r=n?"previous":"next";a&&e.props.updateCell(e.props.name,l.target.value),e.props["".concat(r).concat(t)]()},e}return Object(h.a)(l,[{key:"componentDidMount",value:function(){this.focusSelecTed()}},{key:"componentDidUpdate",value:function(){this.focusSelecTed()}},{key:"printableKey",value:function(e){return e>=48&&e<=90?String.fromCharCode(e):e>=96&&e<=105?String.fromCharCode(e-48):187===e&&"="}},{key:"render",value:function(){var e=this;return this.props.selected?this.props.editing?r.a.createElement("div",{className:"cell selected"},r.a.createElement(O,{onKeyDown:this.onEditingKeyDown})):r.a.createElement("div",{ref:function(t){return e.field=t},className:"cell selected",onClick:this.onSelectCell,onDoubleClick:this.onEditCell,onKeyDown:this.onSelectedKeyDown,tabIndex:"0"},r.a.createElement("div",null,this.props.cell.value||"\xa0")):r.a.createElement("div",{className:"cell",onClick:this.onSelectCell,onDoubleClick:this.onEditCell},r.a.createElement("div",null,this.props.cell.value||"\xa0"))}}]),l}(r.a.Component),k=(n=Object(s.b)((function(e,t){var l=e.sheet.sheet.findCell(t.name);return{selectedCell:e.sheet.selectedCell,cell:l,forceReload:e.sheet.forceReload}}),{updateCell:f,updateEditingCell:v,editCell:function(e,t,l){return{type:"EDIT_CELL",payload:{name:e,selected:t,value:l}}},selectCell:E,nextColumn:g,nextRow:C,previousColumn:w,previousRow:y,deleteCellContents:function(){return{type:"DELETE_CELL_CONTENTS"}}})(N),function(e){Object(p.a)(l,e);var t=Object(d.a)(l);function l(){return Object(m.a)(this,l),t.apply(this,arguments)}return Object(h.a)(l,[{key:"showSquare",value:function(){if(this.props.selected&&!this.props.editing)return r.a.createElement("div",{className:"cell-square"})}},{key:"render",value:function(){var e="".concat(this.props.selected?"selected":""," ").concat(this.props.editing?"editing":""," ").concat(this.props.highlighted&&!this.props.singleHighlight?"highlighted":"");return r.a.createElement("td",{className:e},r.a.createElement("div",{className:"cell-wrapper ".concat(e)},r.a.createElement(n,Object.assign({},this.props,{selected:this.props.selected,editing:this.props.editing,highlighted:this.props.highlighted})),this.showSquare()))}}]),l}(a.Component)),S=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],j=function(e){return S[e]},L=function(e){return e+1},T=function(e,t){return"".concat(j(t)).concat(L(e))},_=function(e){return{row:(l=e[1],parseInt(l)-1),column:(t=e[0],S.indexOf(t.toUpperCase()))};var t,l},R=l(34),D=l(35),x=function(){return r.a.createElement("div",{className:"formula-bar"},r.a.createElement("div",{className:"icon"},r.a.createElement(R.a,{icon:D.a})),r.a.createElement(O,{atFormulaBar:!0}))},F=function(e){Object(p.a)(l,e);var t=Object(d.a)(l);function l(){return Object(m.a)(this,l),t.apply(this,arguments)}return Object(h.a)(l,[{key:"renderCells",value:function(){var e=this;return console.log(this.props.highlightedAreas.single),r.a.createElement("div",{className:"sheet"},r.a.createElement(x,null),r.a.createElement("table",{className:"sheet-table"},r.a.createElement("thead",{style:{textAlign:"right"}},r.a.createElement("tr",null,r.a.createElement("th",{className:"column-header"}),this.props.cells[0].map((function(t,l){var n,a,o;return r.a.createElement("th",{key:"c".concat(l),className:"column-header ".concat((a=null===(n=e.props.selectedCell)||void 0===n?void 0:n.name,o=t.getName(),a&&o&&_(a).column===_(o).column?"selected":""))},r.a.createElement("div",null,j(l)))})))),r.a.createElement("tbody",null,this.props.cells.map((function(t,l){return r.a.createElement("tr",{key:l},t.map((function(t,n){var o,c,s,i,u;return r.a.createElement(a.Fragment,{key:n},0===n?r.a.createElement("th",{className:"row-header ".concat((i=null===(o=e.props.selectedCell)||void 0===o?void 0:o.name,u=t.getName(),i&&u&&_(i).row===_(u).row?"selected":""))},r.a.createElement("div",null,L(l))):r.a.createElement(r.a.Fragment,null),r.a.createElement(k,{name:t.getName(),selected:(null===(c=e.props.selectedCell)||void 0===c?void 0:c.name)===t.getName(),editing:(null===(s=e.props.selectedCell)||void 0===s?void 0:s.name)===t.getName()&&e.props.selectedCell.editing,highlighted:t.isHighlighted(e.props.highlightedAreas),singleHighlight:t.isHighlighted(e.props.highlightedAreas)&&e.props.highlightedAreas.single}))})))})))))}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderCells())}}]),l}(r.a.Component),A=Object(s.b)((function(e){return{cells:e.sheet.sheet.cells,selectedCell:e.sheet.selectedCell,highlightedAreas:e.sheet.highlightedAreas}}),{})(F),B=l(6),U=Object(B.a)(),I=function(){return r.a.createElement("div",{className:"help"},r.a.createElement("p",null,"This app is a work in progress by"," ",r.a.createElement("a",{href:"https://www.linkedin.com/in/diegostiehl",rel:"noopener noreferrer",target:"_blank"},"Diego Stiehl"),". You can see its code here:"," ",r.a.createElement("a",{href:"https://github.com/seccomiro/react-sheets",rel:"noopener noreferrer",target:"_blank"},"https://github.com/seccomiro/react-sheets"),"."),r.a.createElement("p",null,"At this point in time you can:"),r.a.createElement("ul",null,r.a.createElement("li",null,"Navigate through cells (enabling editing of them) using ",r.a.createElement("em",null,"TAB"),","," ",r.a.createElement("em",null,"ENTER"),", ",r.a.createElement("em",null,"arrows")," or ",r.a.createElement("em",null,"mouse"),"."),r.a.createElement("li",null,"Edit cells using ",r.a.createElement("em",null,"F2"),", ",r.a.createElement("em",null,"ENTER")," or by clicking at the ",r.a.createElement("em",null,"Formula Bar"),"."),r.a.createElement("li",null,"Cancel editing using ",r.a.createElement("em",null,"ESC"),"."),r.a.createElement("li",null,"Type ",r.a.createElement("em",null,"numeric")," values, like ",r.a.createElement("em",null,"10")," or ",r.a.createElement("em",null,"99.56")," at any available cell."),r.a.createElement("li",null,"Type simple math formulas using the cells, like:"," ",r.a.createElement("em",null,"=A1+(B2/C3)*D5-10")," (try to avoid circular references because it's not solved yet)."),r.a.createElement("li",null,"Edit the values of cells yout pointed on any formula and watch the"," ",r.a.createElement("em",null,"automatic recalculation")," of the entire spreadsheet.",r.a.createElement("ul",null,r.a.createElement("li",null,"Tip: Try to write a formula that depends on two cells that have formulas that depends on other cells that have regular numbers and, after that, change these regular numbers.")))))},K=function(){return r.a.createElement("div",null,r.a.createElement(i.a,{history:U,basename:"/react-sheets"},r.a.createElement(u.c,null,r.a.createElement(u.a,{path:"/",exact:!0,component:A}))),r.a.createElement(I,null))},M=l(15),P=l(38),H=l(23),X=l(10),V=l(30),W=l.n(V),q=l(58),G=/([+,*,/,=,\-,(,)])/g,J=function(e){return!Y(e)&&""!==e&&"="!==e&&!e.match(G)},Y=function(e){return!isNaN(e)},$=function(){function e(t){var l=t.sheet,n=t.formula,a=void 0===n?"0":n,r=t.value,o=void 0===r?"0":r;Object(m.a)(this,e),this.sheet=l,this.formula=a,this.value=o,this.listeners=new Set,this.pointedCells={}}return Object(h.a)(e,[{key:"setFormula",value:function(e){this.formula=e;var t=function(e){var t=e.split(G).filter((function(e){return J(e.trim())}));return Object(H.a)(new Set(t))}(e);this.pointedCells=this.sheet.register(this,t),this.evaluate()}},{key:"registerListener",value:function(e){this.listeners.add(e)}},{key:"getName",value:function(){return this.sheet.getCellName(this)}},{key:"isHighlighted",value:function(e){return this.sheet.cellIsHighlighted(this.getName(),e)}},{key:"evaluate",value:function(){var e,t;this.formula.startsWith("=")?this.value=(e=this.formula.substring(1,this.formula.length),t=this.pointedCellParams(),Object(q.a)(e,t)):this.value=this.formula,this.listeners.forEach((function(e){return e.evaluate()}))}},{key:"pointedCellParams",value:function(){var e=this,t={};return Object.keys(this.pointedCells).forEach((function(l){return t[l]=e.pointedCells[l].value})),t}}]),e}(),z=new(function(){function e(t){var l=t.rows,n=t.columns,a=t.name;Object(m.a)(this,e),this.cellNames=new Map,this.cells=this.createCells(l,n),this.name=a}return Object(h.a)(e,[{key:"register",value:function(e,t){var l=this;return t.map((function(e){return l.findCell(e)})).forEach((function(t){return t.registerListener(e)})),this.cellMap(t)}},{key:"cellMap",value:function(e){var t=this,l={};return e.forEach((function(e){var n=t.findCell(e);l[e]=n})),l}},{key:"findCell",value:function(e){var t=_(e);return this.cells[t.row][t.column]}},{key:"findCells",value:function(e,t){for(var l=_(e),n=_(t),a={row:{start:l.row<=n.row?l.row:n.row,end:l.row<=n.row?n.row:l.row},column:{start:l.column<=n.column?l.column:n.column,end:l.column<=n.column?n.column:l.column}},r=[],o=[],c=a.row.start;c<=a.row.end;c++)for(var s=a.column.start;s<=a.column.end;s++){var i=this.cells[c][s];r.push(i),o.push(i.getName())}return{cells:r,cellNames:o}}},{key:"cellIsHighlighted",value:function(e,t){return!!t.find((function(t){return t.cellNames.includes(e)}))}},{key:"updateCell",value:function(e,t){this.findCell(e).setFormula(t)}},{key:"updateCells",value:function(e,t){var l=this;e.forEach((function(e){return l.updateCell(e,t)}))}},{key:"createCells",value:function(e,t){for(var l=[],n=0;n<e;n++){l[n]=[];for(var a=0;a<t;a++){var r=new $({sheet:this,formula:"",value:""});l[n][a]=r,this.cellNames.set(r,T(n,a))}}return l}},{key:"getCellName",value:function(e){return this.cellNames.get(e)}},{key:"size",value:function(){return{rows:this.rows(),columns:this.columns()}}},{key:"rows",value:function(){return this.cells.length}},{key:"columns",value:function(){return this.cells[0].length}},{key:"nextRow",value:function(e){var t=_(e),l=t.row===this.rows()-1?0:t.row+1;return T(l,t.column)}},{key:"nextColumn",value:function(e){var t=_(e),l=t.column===this.columns()-1?0:t.column+1;return T(t.row,l)}},{key:"previousRow",value:function(e){var t=_(e),l=0===t.row?this.rows()-1:t.row-1;return T(l,t.column)}},{key:"previousColumn",value:function(e){var t=_(e),l=0===t.column?this.columns()-1:t.column-1;return T(t.row,l)}}]),e}())({rows:9,columns:26,name:"Sheet 1"}),Q=z.findCell("A1"),Z={sheet:z,selectedCell:{name:Q.getName(),editing:!1,tempFormula:Q.formula,formulaBarSelected:!1},highlightedAreas:[{start:Q.getName(),end:Q.getName(),cells:[Q],cellNames:[Q.getName()]}],forceReload:Math.random()};Z.highlightedAreas.single=!0;var ee=function(e){return 1===e.length&&e[0].start===e[0].end},te=Object(M.c)({sheet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Z,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_EDITING_CELL":return W()(e,{selectedCell:{tempFormula:{$set:t.payload.toUpperCase()}}});case"UPDATE_CELL":var l=t.payload,n=l.cellName,a=l.formula;return e.sheet.updateCell(n,a),e;case"SELECT_CELL":var r=t.payload.options,o=r.shift,c=r.ctrl,s=e.highlightedAreas;if(o&&c);else if(o){var i=e.selectedCell.name,u=t.payload.name,m=e.sheet.findCells(i,u),h=m.cells,d=m.cellNames,p={start:i,end:u,cells:h,cellNames:d};s=[p]}else if(c){var f={start:t.payload.name,end:t.payload.name,cells:[e.sheet.findCell(t.payload.name)],cellNames:[t.payload.name]};s.push(f)}else{var v={start:t.payload.name,end:t.payload.name,cells:[e.sheet.findCell(t.payload.name)],cellNames:[t.payload.name]};s=[v]}return s.single=ee(s),Object(X.a)({},e,{selectedCell:t.payload.selected?{name:t.payload.name,tempFormula:e.sheet.findCell(t.payload.name).formula,editing:!1,formulaBarSelected:!1}:void 0,highlightedAreas:s});case"EDIT_CELL":return Object(X.a)({},e,{selectedCell:t.payload.selected?{name:t.payload.name,tempFormula:t.payload.value||e.sheet.findCell(t.payload.name).formula,editing:!0,formulaBarSelected:!1}:void 0});case"SELECT_FORMULA_BAR":return W()(e,{selectedCell:{formulaBarSelected:{$set:t.payload.entering}}});case"NEXT_COLUMN":var E=e.sheet.nextColumn(e.selectedCell.name),C=e.sheet.findCell(E).formula;return Object(X.a)({},e,{selectedCell:Object(X.a)({},e.selectedCell,{name:E,tempFormula:C,editing:!1,formulaBarSelected:!1})});case"NEXT_ROW":var g=e.sheet.nextRow(e.selectedCell.name),y=e.sheet.findCell(g).formula;return Object(X.a)({},e,{selectedCell:Object(X.a)({},e.selectedCell,{name:g,tempFormula:y,editing:!1,formulaBarSelected:!1})});case"PREVIOUS_COLUMN":var w=e.sheet.previousColumn(e.selectedCell.name),b=e.sheet.findCell(w).formula;return Object(X.a)({},e,{selectedCell:Object(X.a)({},e.selectedCell,{name:w,tempFormula:b,editing:!1,formulaBarSelected:!1})});case"PREVIOUS_ROW":var O=e.sheet.previousRow(e.selectedCell.name),N=e.sheet.findCell(O).formula;return Object(X.a)({},e,{selectedCell:Object(X.a)({},e.selectedCell,{name:O,tempFormula:N,editing:!1,formulaBarSelected:!1})});case"DELETE_CELL_CONTENTS":var k=Object(H.a)(new Set(e.highlightedAreas.map((function(e){return e.cellNames})).flat()));return e.sheet.updateCells(k,""),Object(X.a)({},e,{forceReload:Math.random()});default:return e}}}),le=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||M.d,ne=Object(M.e)(te,le(Object(M.a)(P.a)));c.a.render(r.a.createElement(s.a,{store:ne},r.a.createElement(K,null)),document.querySelector("#root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.42aeffc7.chunk.js.map