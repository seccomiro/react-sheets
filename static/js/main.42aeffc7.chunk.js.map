{"version":3,"sources":["components/cellWrapper.js","actions/index.js","actions/types.js","components/FormulaInput.js","components/Cell.js","logic/cell.js","components/FormulaBar.js","components/Sheet.js","history.js","components/Help.js","components/App.js","logic/formula.js","logic/Cell.js","reducers/sheetReducer.js","logic/Sheet.js","reducers/index.js","store.js","index.js"],"names":["ChildComponent","updateCell","cellName","formula","type","payload","updateEditingCell","value","selectCell","name","selected","options","nextRow","nextColumn","previousRow","previousColumn","FormulaInput","onChange","e","props","target","onKeyDown","which","nextElement","previous","save","preventDefault","way","onFocus","atFormulaBar","selectFormulaBar","onBlur","this","autoFocus","formulaBarSelected","Component","connect","state","sheet","selectedCell","tempFormula","entering","Cell","focusSelecTed","field","focus","onEditCell","editCell","onSelectCell","shift","shiftKey","ctrl","ctrlKey","onEditingKeyDown","onSelectedKeyDown","deleteCellContents","printableKey","key","String","fromCharCode","editing","className","ref","onClick","onDoubleClick","tabIndex","cell","React","cellWrapper","ownProps","findCell","forceReload","selectedClass","highlighted","singleHighlight","showSquare","letters","indexToColumn","i","indexToRow","indexToCell","iRow","iColumn","cellToIndex","row","parseInt","column","indexOf","toUpperCase","FormulaBar","icon","faCalculator","Sheet","console","log","highlightedAreas","single","style","textAlign","cells","map","cellName1","cellName2","getName","j","isHighlighted","renderCells","createBrowserHistory","Help","href","rel","App","history","basename","process","path","exact","component","operators","isCell","isNumber","match","isNaN","listeners","Set","pointedCells","cellNames","presentCells","split","filter","trim","register","evaluate","add","getCellName","cellIsHighlighted","params","startsWith","substring","length","pointedCellParams","forEach","Object","keys","initialSheet","rows","columns","Map","createCells","pointingCell","pointedCellNames","registerListener","cellMap","index","startName","endName","start","end","loop","col","push","find","a","includes","setFormula","rowCount","columnCount","set","get","firstCell","INITIAL_STATE","Math","random","combineReducers","action","update","$set","findCells","newArea","undefined","nextColumnName","nextColumnFormula","nextRowName","nextRowFormula","previousColumnName","previousColumnFormula","previousRowName","previousRowFormula","flat","updateCells","composeEnhancers","window","__REDUX_DEVTOOLS_EXTENSION_COMPOSE__","compose","store","createStore","reducers","applyMiddleware","reduxThunk","ReactDOM","render","document","querySelector"],"mappings":"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","file":"static/js/main.42aeffc7.chunk.js","sourcesContent":["import React, { Component } from 'react';\n// import { connect } from 'react-redux';\n\nexport default ChildComponent => {\n  class CellWrapper extends Component {\n    showSquare() {\n      if (this.props.selected && !this.props.editing) {\n        return <div className=\"cell-square\"></div>;\n      }\n    }\n\n    render() {\n      const selectedClass = `${this.props.selected ? 'selected' : ''} ${\n        this.props.editing ? 'editing' : ''\n      } ${\n        this.props.highlighted && !this.props.singleHighlight\n          ? 'highlighted'\n          : ''\n      }`;\n\n      return (\n        <td className={selectedClass}>\n          <div className={`cell-wrapper ${selectedClass}`}>\n            <ChildComponent\n              {...this.props}\n              selected={this.props.selected}\n              editing={this.props.editing}\n              highlighted={this.props.highlighted}\n            />\n            {this.showSquare()}\n          </div>\n        </td>\n      );\n    }\n  }\n\n  return CellWrapper;\n};\n","import {\n  UPDATE_CELL,\n  SELECT_CELL,\n  NEXT_ROW,\n  NEXT_COLUMN,\n  UPDATE_EDITING_CELL,\n  EDIT_CELL,\n  PREVIOUS_ROW,\n  PREVIOUS_COLUMN,\n  SELECT_FORMULA_BAR,\n  DELETE_CELL_CONTENTS,\n} from './types';\n\nexport const updateCell = (cellName, formula) => {\n  return { type: UPDATE_CELL, payload: { cellName, formula } };\n};\n\nexport const updateEditingCell = value => {\n  return { type: UPDATE_EDITING_CELL, payload: value };\n};\n\nexport const selectCell = (name, selected, options = {}) => {\n  return { type: SELECT_CELL, payload: { name, selected, options } };\n};\n\nexport const editCell = (name, selected, value) => {\n  return { type: EDIT_CELL, payload: { name, selected, value } };\n};\n\nexport const nextRow = () => {\n  return { type: NEXT_ROW };\n};\n\nexport const nextColumn = () => {\n  return { type: NEXT_COLUMN };\n};\n\nexport const previousRow = () => {\n  return { type: PREVIOUS_ROW };\n};\n\nexport const previousColumn = () => {\n  return { type: PREVIOUS_COLUMN };\n};\n\nexport const selectFormulaBar = (entering = true) => {\n  return { type: SELECT_FORMULA_BAR, payload: { entering } };\n};\n\nexport const deleteCellContents = () => {\n  return { type: DELETE_CELL_CONTENTS };\n};\n","export const UPDATE_CELL = 'UPDATE_CELL';\nexport const UPDATE_EDITING_CELL = 'UPDATE_EDITING_CELL';\nexport const SELECT_CELL = 'SELECT_CELL';\nexport const EDIT_CELL = 'EDIT_CELL';\nexport const NEXT_ROW = 'NEXT_ROW';\nexport const NEXT_COLUMN = 'NEXT_COLUMN';\nexport const PREVIOUS_ROW = 'PREVIOUS_ROW';\nexport const PREVIOUS_COLUMN = 'PREVIOUS_COLUMN';\nexport const SELECT_FORMULA_BAR = 'SELECT_FORMULA_BAR';\nexport const DELETE_CELL_CONTENTS = 'DELETE_CELL_CONTENTS';\n","import React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport {\n  updateEditingCell,\n  updateCell,\n  nextColumn,\n  nextRow,\n  previousColumn,\n  previousRow,\n  selectFormulaBar,\n  selectCell,\n} from '../actions';\n\nclass FormulaInput extends Component {\n  onChange = e => {\n    this.props.updateEditingCell(e.target.value);\n  };\n\n  onKeyDown = e => {\n    if (e.which === 9) this.nextElement('Column', e, false, true);\n    else if (e.which === 13) this.nextElement('Row', e, false, true);\n    else if (e.which === 27) this.props.selectCell(this.props.name, true);\n  };\n\n  nextElement = (type, e, previous = false, save = false) => {\n    e.preventDefault();\n    const way = previous ? 'previous' : 'next';\n    if (save) {\n      this.props.updateCell(this.props.name, e.target.value);\n    }\n    this.props[`${way}${type}`]();\n  };\n\n  onFocus = () => {\n    if (this.props.atFormulaBar) {\n      this.props.selectFormulaBar(true);\n    }\n  };\n\n  onBlur = e => {\n    if (this.props.atFormulaBar) {\n      this.props.selectFormulaBar(false);\n    }\n    this.props.updateCell(this.props.name, e.target.value);\n  };\n\n  render() {\n    return (\n      <input\n        onFocus={this.onFocus}\n        onBlur={this.onBlur}\n        onKeyDown={this.onKeyDown}\n        onChange={this.onChange}\n        type=\"text\"\n        value={this.props.formula}\n        autoFocus={!this.props.formulaBarSelected}\n      />\n    );\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    formula: state.sheet.selectedCell.tempFormula,\n    name: state.sheet.selectedCell.name,\n    formulaBarSelected: state.sheet.selectedCell.formulaBarSelected,\n  };\n};\n\nexport default connect(mapStateToProps, {\n  updateEditingCell,\n  updateCell,\n  nextColumn,\n  nextRow,\n  previousColumn,\n  previousRow,\n  selectFormulaBar,\n  selectCell,\n})(FormulaInput);\n","import React from 'react';\nimport { connect } from 'react-redux';\nimport {\n  updateCell,\n  updateEditingCell,\n  editCell,\n  selectCell,\n  nextColumn,\n  nextRow,\n  previousColumn,\n  previousRow,\n  deleteCellContents,\n} from '../actions';\nimport cellWrapper from './cellWrapper';\nimport FormulaInput from './FormulaInput';\n\nclass Cell extends React.Component {\n  componentDidMount() {\n    this.focusSelecTed();\n  }\n\n  componentDidUpdate() {\n    this.focusSelecTed();\n  }\n\n  focusSelecTed = () => {\n    if (this.field && !this.props.selectedCell.formulaBarSelected) {\n      this.field.focus();\n    }\n  };\n\n  onEditCell = e => {\n    this.props.editCell(this.props.name, true);\n  };\n\n  onSelectCell = e => {\n    this.props.selectCell(this.props.name, true, {\n      shift: !!e.shiftKey,\n      ctrl: !!e.ctrlKey,\n    });\n  };\n\n  onEditingKeyDown = e => {\n    if (e.which === 13) this.nextElement('Row', e, false, true);\n    else if (e.which === 37) this.nextElement('Column', e, true, true);\n    else if (e.which === 38) this.nextElement('Row', e, true, true);\n    else if (e.which === 39) this.nextElement('Column', e, false, true);\n    else if (e.which === 40) this.nextElement('Row', e, false, true);\n  };\n\n  onSelectedKeyDown = e => {\n    if (e.which === 113 || e.which === 13) {\n      e.preventDefault();\n      this.props.editCell(this.props.name, true);\n    } else if (e.which === 9) this.nextElement('Column', e);\n    else if (e.which === 37) this.nextElement('Column', e, true);\n    else if (e.which === 38) this.nextElement('Row', e, true);\n    else if (e.which === 39) this.nextElement('Column', e);\n    else if (e.which === 40) this.nextElement('Row', e);\n    else if (e.which === 46) this.props.deleteCellContents();\n    else if (this.printableKey(e.which)) {\n      e.preventDefault();\n      this.props.editCell(this.props.name, true, this.printableKey(e.which));\n    }\n  };\n\n  nextElement = (type, e, previous = false, save = false) => {\n    e.preventDefault();\n    const way = previous ? 'previous' : 'next';\n    if (save) {\n      this.props.updateCell(this.props.name, e.target.value);\n    }\n    this.props[`${way}${type}`]();\n  };\n\n  printableKey(key) {\n    // Only letters, numbers and equal for now\n    if (key >= 48 && key <= 90) {\n      return String.fromCharCode(key);\n    } else if (key >= 96 && key <= 105) {\n      return String.fromCharCode(key - 48);\n    } else if (key === 187) {\n      return '=';\n    }\n    return false;\n  }\n\n  render() {\n    if (this.props.selected) {\n      if (this.props.editing) {\n        return (\n          <div className=\"cell selected\">\n            <FormulaInput onKeyDown={this.onEditingKeyDown} />\n          </div>\n        );\n      } else {\n        return (\n          <div\n            ref={field => (this.field = field)}\n            className=\"cell selected\"\n            onClick={this.onSelectCell}\n            onDoubleClick={this.onEditCell}\n            onKeyDown={this.onSelectedKeyDown}\n            tabIndex=\"0\"\n          >\n            <div>{this.props.cell.value || '\\u00A0'}</div>\n          </div>\n        );\n      }\n    } else {\n      return (\n        <div\n          className=\"cell\"\n          onClick={this.onSelectCell}\n          onDoubleClick={this.onEditCell}\n        >\n          <div>{this.props.cell.value || '\\u00A0'}</div>\n        </div>\n      );\n    }\n  }\n}\n\nconst mapStateToProps = (state, ownProps) => {\n  const cell = state.sheet.sheet.findCell(ownProps.name);\n  return {\n    selectedCell: state.sheet.selectedCell,\n    cell,\n    forceReload: state.sheet.forceReload,\n  };\n};\n\nexport default cellWrapper(\n  connect(mapStateToProps, {\n    updateCell,\n    updateEditingCell,\n    editCell,\n    selectCell,\n    nextColumn,\n    nextRow,\n    previousColumn,\n    previousRow,\n    deleteCellContents,\n  })(Cell)\n);\n","const letters = [\n  'A',\n  'B',\n  'C',\n  'D',\n  'E',\n  'F',\n  'G',\n  'H',\n  'I',\n  'J',\n  'K',\n  'L',\n  'M',\n  'N',\n  'O',\n  'P',\n  'Q',\n  'R',\n  'S',\n  'T',\n  'U',\n  'V',\n  'W',\n  'X',\n  'Y',\n  'Z',\n];\n\nexport const indexToColumn = i => letters[i];\n\nexport const columnToIndex = column => letters.indexOf(column.toUpperCase());\n\nexport const rowToIndex = row => parseInt(row) - 1;\n\nexport const indexToRow = i => i + 1;\n\nexport const indexToCell = (iRow, iColumn) =>\n  `${indexToColumn(iColumn)}${indexToRow(iRow)}`;\n\nexport const cellToIndex = cell => ({\n  row: rowToIndex(cell[1]),\n  column: columnToIndex(cell[0]),\n});\n\nexport const sameRow = (cellName1, cellName2) =>\n  cellName1 &&\n  cellName2 &&\n  cellToIndex(cellName1).row === cellToIndex(cellName2).row;\n\nexport const sameColumn = (cellName1, cellName2) =>\n  cellName1 &&\n  cellName2 &&\n  cellToIndex(cellName1).column === cellToIndex(cellName2).column;\n","import React from 'react';\nimport FormulaInput from './FormulaInput';\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\nimport { faCalculator } from '@fortawesome/free-solid-svg-icons';\n\nconst FormulaBar = () => (\n  <div className=\"formula-bar\">\n    <div className=\"icon\">\n      <FontAwesomeIcon icon={faCalculator} />\n    </div>\n    <FormulaInput atFormulaBar={true} />\n  </div>\n);\n\nexport default FormulaBar;\n","import React, { Fragment } from 'react';\nimport { connect } from 'react-redux';\nimport Cell from './Cell';\nimport { indexToRow, indexToColumn, sameColumn, sameRow } from '../logic/cell';\nimport FormulaBar from './FormulaBar';\n\nclass Sheet extends React.Component {\n  renderCells() {\n    console.log(this.props.highlightedAreas.single);\n    return (\n      <div className=\"sheet\">\n        <FormulaBar />\n        <table className=\"sheet-table\">\n          <thead style={{ textAlign: 'right' }}>\n            <tr>\n              <th className=\"column-header\"></th>\n              {this.props.cells[0].map((cell, i) => (\n                <th\n                  key={`c${i}`}\n                  className={`column-header ${\n                    sameColumn(this.props.selectedCell?.name, cell.getName())\n                      ? 'selected'\n                      : ''\n                  }`}\n                >\n                  <div>{indexToColumn(i)}</div>\n                </th>\n              ))}\n            </tr>\n          </thead>\n          <tbody>\n            {this.props.cells.map((row, i) => (\n              <tr key={i}>\n                {row.map((cell, j) => (\n                  <Fragment key={j}>\n                    {j === 0 ? (\n                      <th\n                        className={`row-header ${\n                          sameRow(this.props.selectedCell?.name, cell.getName())\n                            ? 'selected'\n                            : ''\n                        }`}\n                      >\n                        <div>{indexToRow(i)}</div>\n                      </th>\n                    ) : (\n                      <></>\n                    )}\n                    <Cell\n                      name={cell.getName()}\n                      selected={\n                        this.props.selectedCell?.name === cell.getName()\n                      }\n                      editing={\n                        this.props.selectedCell?.name === cell.getName() &&\n                        this.props.selectedCell.editing\n                      }\n                      highlighted={cell.isHighlighted(\n                        this.props.highlightedAreas\n                      )}\n                      singleHighlight={\n                        cell.isHighlighted(this.props.highlightedAreas) &&\n                        this.props.highlightedAreas.single\n                      }\n                    />\n                  </Fragment>\n                ))}\n              </tr>\n            ))}\n          </tbody>\n        </table>\n      </div>\n    );\n  }\n\n  render() {\n    return <div>{this.renderCells()}</div>;\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    cells: state.sheet.sheet.cells,\n    selectedCell: state.sheet.selectedCell,\n    highlightedAreas: state.sheet.highlightedAreas,\n  };\n};\n\nexport default connect(mapStateToProps, {})(Sheet);\n","import { createBrowserHistory } from 'history';\nexport default createBrowserHistory();\n","import React from 'react';\n\nconst Help = () => (\n  <div className=\"help\">\n    <p>\n      This app is a work in progress by{' '}\n      <a\n        href=\"https://www.linkedin.com/in/diegostiehl\"\n        rel=\"noopener noreferrer\"\n        target=\"_blank\"\n      >\n        Diego Stiehl\n      </a>\n      . You can see its code here:{' '}\n      <a\n        href=\"https://github.com/seccomiro/react-sheets\"\n        rel=\"noopener noreferrer\"\n        target=\"_blank\"\n      >\n        https://github.com/seccomiro/react-sheets\n      </a>\n      .\n    </p>\n    <p>At this point in time you can:</p>\n    <ul>\n      <li>\n        Navigate through cells (enabling editing of them) using <em>TAB</em>,{' '}\n        <em>ENTER</em>, <em>arrows</em> or <em>mouse</em>.\n      </li>\n      <li>\n        Edit cells using <em>F2</em>, <em>ENTER</em> or by clicking at the <em>Formula Bar</em>.\n      </li>\n      <li>\n        Cancel editing using <em>ESC</em>.\n      </li>\n      <li>\n        Type <em>numeric</em> values, like <em>10</em> or <em>99.56</em> at any available\n        cell.\n      </li>\n      <li>\n        Type simple math formulas using the cells, like:{' '}\n        <em>=A1+(B2/C3)*D5-10</em> (try to avoid circular references because\n        it's not solved yet).\n      </li>\n      <li>\n        Edit the values of cells yout pointed on any formula and watch the{' '}\n        <em>automatic recalculation</em> of the entire spreadsheet.\n        <ul>\n          <li>\n            Tip: Try to write a formula that depends on two cells that have\n            formulas that depends on other cells that have regular numbers and,\n            after that, change these regular numbers.\n          </li>\n        </ul>\n      </li>\n    </ul>\n  </div>\n);\n\nexport default Help;\n","import React from 'react';\nimport { Route, Switch, HashRouter } from 'react-router-dom';\nimport Sheet from './Sheet';\nimport history from '../history';\nimport Help from './Help';\n\nconst App = () => {\n  return (\n    <div>\n      <HashRouter history={history} basename={process.env.PUBLIC_URL}>\n        <Switch>\n          <Route path=\"/\" exact component={Sheet} />\n        </Switch>\n      </HashRouter>\n      <Help />\n    </div>\n  );\n};\n\nexport default App;\n","import { evaluate } from 'mathjs';\n\nexport const operators = /([+,*,/,=,\\-,(,)])/g;\n\nexport const pointedCells = formula => {\n  const presentCells = formula.split(operators).filter(e => isCell(e.trim()));\n  return [...new Set(presentCells)];\n};\n\nexport const isCell = value =>\n  !isNumber(value) && value !== '' && value !== '=' && !value.match(operators);\n\nexport const isNumber = value => !isNaN(value);\n\nexport const evaluateFormula = (formula, params) => {\n  return evaluate(formula, params);\n};\n","import { pointedCells, evaluateFormula } from './formula';\n\nclass Cell {\n  constructor({ sheet, formula = '0', value = '0' }) {\n    this.sheet = sheet;\n    this.formula = formula;\n    this.value = value;\n    this.listeners = new Set();\n    this.pointedCells = {};\n  }\n\n  setFormula(formula) {\n    this.formula = formula;\n    const cellNames = pointedCells(formula);\n    this.pointedCells = this.sheet.register(this, cellNames);\n    this.evaluate();\n  }\n\n  registerListener(cell) {\n    this.listeners.add(cell);\n  }\n\n  getName() {\n    return this.sheet.getCellName(this);\n  }\n\n  isHighlighted(highlightedAreas) {\n    return this.sheet.cellIsHighlighted(this.getName(), highlightedAreas);\n  }\n\n  evaluate() {\n    if (this.formula.startsWith('=')) {\n      this.value = evaluateFormula(\n        this.formula.substring(1, this.formula.length),\n        this.pointedCellParams()\n      );\n    } else {\n      this.value = this.formula;\n    }\n\n    this.listeners.forEach(cell => cell.evaluate());\n  }\n\n  pointedCellParams() {\n    const map = {};\n    Object.keys(this.pointedCells).forEach(\n      cellName => (map[cellName] = this.pointedCells[cellName].value)\n    );\n    return map;\n  }\n}\n\nexport default Cell;\n","import {\n  UPDATE_CELL,\n  EDIT_CELL,\n  NEXT_COLUMN,\n  NEXT_ROW,\n  UPDATE_EDITING_CELL,\n  SELECT_CELL,\n  PREVIOUS_COLUMN,\n  PREVIOUS_ROW,\n  SELECT_FORMULA_BAR,\n  DELETE_CELL_CONTENTS,\n} from '../actions/types';\nimport update from 'react-addons-update';\nimport Sheet from '../logic/Sheet';\n\nconst initialSheet = new Sheet({ rows: 9, columns: 26, name: 'Sheet 1' });\nconst firstCell = initialSheet.findCell('A1');\n\nconst INITIAL_STATE = {\n  sheet: initialSheet,\n  selectedCell: {\n    name: firstCell.getName(),\n    editing: false,\n    tempFormula: firstCell.formula,\n    formulaBarSelected: false,\n  },\n  highlightedAreas: [\n    {\n      start: firstCell.getName(),\n      end: firstCell.getName(),\n      cells: [firstCell],\n      cellNames: [firstCell.getName()],\n    },\n  ],\n  forceReload: Math.random(),\n};\n\nINITIAL_STATE.highlightedAreas.single = true;\n\nconst singleHighlight = highlightedAreas =>\n  highlightedAreas.length === 1 &&\n  highlightedAreas[0].start === highlightedAreas[0].end;\n\nexport default (state = INITIAL_STATE, action) => {\n  switch (action.type) {\n    case UPDATE_EDITING_CELL:\n      return update(state, {\n        selectedCell: {\n          tempFormula: { $set: action.payload.toUpperCase() },\n        },\n      });\n    case UPDATE_CELL:\n      const { cellName, formula } = action.payload;\n      /**\n       * I know! We're mutating the state inside the store here.\n       * This will be fixed as formula change tracking process is well defined.\n       * By now, we need this to have every cell value updated.\n       */\n      state.sheet.updateCell(cellName, formula);\n\n      return state;\n    case SELECT_CELL:\n      const { shift, ctrl } = action.payload.options;\n      let { highlightedAreas } = state;\n\n      if (shift && ctrl) {\n      } else if (shift) {\n        const start = state.selectedCell.name;\n        const end = action.payload.name;\n        const { cells, cellNames } = state.sheet.findCells(start, end);\n        const newArea = { start, end, cells, cellNames };\n        highlightedAreas = [newArea];\n      } else if (ctrl) {\n        const newArea = {\n          start: action.payload.name,\n          end: action.payload.name,\n          cells: [state.sheet.findCell(action.payload.name)],\n          cellNames: [action.payload.name],\n        };\n        highlightedAreas.push(newArea);\n      } else {\n        const newArea = {\n          start: action.payload.name,\n          end: action.payload.name,\n          cells: [state.sheet.findCell(action.payload.name)],\n          cellNames: [action.payload.name],\n        };\n        highlightedAreas = [newArea];\n      }\n      highlightedAreas.single = singleHighlight(highlightedAreas);\n\n      return {\n        ...state,\n        selectedCell: action.payload.selected\n          ? {\n              name: action.payload.name,\n              tempFormula: state.sheet.findCell(action.payload.name).formula,\n              editing: false,\n              formulaBarSelected: false,\n            }\n          : undefined,\n        highlightedAreas,\n      };\n    case EDIT_CELL:\n      return {\n        ...state,\n        selectedCell: action.payload.selected\n          ? {\n              name: action.payload.name,\n              tempFormula:\n                action.payload.value ||\n                state.sheet.findCell(action.payload.name).formula,\n              editing: true,\n              formulaBarSelected: false,\n            }\n          : undefined,\n      };\n    case SELECT_FORMULA_BAR:\n      return update(state, {\n        selectedCell: {\n          formulaBarSelected: { $set: action.payload.entering },\n        },\n      });\n    case NEXT_COLUMN:\n      const nextColumnName = state.sheet.nextColumn(state.selectedCell.name);\n      const nextColumnFormula = state.sheet.findCell(nextColumnName).formula;\n      return {\n        ...state,\n        selectedCell: {\n          ...state.selectedCell,\n          name: nextColumnName,\n          tempFormula: nextColumnFormula,\n          editing: false,\n          formulaBarSelected: false,\n        },\n      };\n    case NEXT_ROW:\n      const nextRowName = state.sheet.nextRow(state.selectedCell.name);\n      const nextRowFormula = state.sheet.findCell(nextRowName).formula;\n      return {\n        ...state,\n        selectedCell: {\n          ...state.selectedCell,\n          name: nextRowName,\n          tempFormula: nextRowFormula,\n          editing: false,\n          formulaBarSelected: false,\n        },\n      };\n    case PREVIOUS_COLUMN:\n      const previousColumnName = state.sheet.previousColumn(\n        state.selectedCell.name\n      );\n      const previousColumnFormula = state.sheet.findCell(previousColumnName)\n        .formula;\n      return {\n        ...state,\n        selectedCell: {\n          ...state.selectedCell,\n          name: previousColumnName,\n          tempFormula: previousColumnFormula,\n          editing: false,\n          formulaBarSelected: false,\n        },\n      };\n    case PREVIOUS_ROW:\n      const previousRowName = state.sheet.previousRow(state.selectedCell.name);\n      const previousRowFormula = state.sheet.findCell(previousRowName).formula;\n      return {\n        ...state,\n        selectedCell: {\n          ...state.selectedCell,\n          name: previousRowName,\n          tempFormula: previousRowFormula,\n          editing: false,\n          formulaBarSelected: false,\n        },\n      };\n    case DELETE_CELL_CONTENTS:\n      /**\n       * See UPDATE_CELL's explanation\n       */\n      const cellNames = [\n        ...new Set(state.highlightedAreas.map(a => a.cellNames).flat()),\n      ];\n      state.sheet.updateCells(cellNames, '');\n      return { ...state, forceReload: Math.random() };\n    default:\n      return state;\n  }\n};\n","import Cell from './Cell';\nimport { cellToIndex, indexToCell } from './cell';\n\nclass Sheet {\n  constructor({ rows, columns, name }) {\n    this.cellNames = new Map();\n    this.cells = this.createCells(rows, columns);\n    this.name = name;\n  }\n\n  register(pointingCell, pointedCellNames) {\n    pointedCellNames\n      .map(name => this.findCell(name))\n      .forEach(cell => cell.registerListener(pointingCell));\n    return this.cellMap(pointedCellNames);\n  }\n\n  cellMap(cellNames) {\n    const map = {};\n    cellNames.forEach(name => {\n      const cell = this.findCell(name);\n      map[name] = cell;\n    });\n    return map;\n  }\n\n  findCell(name) {\n    const index = cellToIndex(name);\n    return this.cells[index.row][index.column];\n  }\n\n  findCells(startName, endName) {\n    const start = cellToIndex(startName);\n    const end = cellToIndex(endName);\n    const loop = {\n      row: {\n        start: start.row <= end.row ? start.row : end.row,\n        end: start.row <= end.row ? end.row : start.row,\n      },\n      column: {\n        start: start.column <= end.column ? start.column : end.column,\n        end: start.column <= end.column ? end.column : start.column,\n      },\n    };\n    const cells = [];\n    const cellNames = [];\n    for (let row = loop.row.start; row <= loop.row.end; row++) {\n      for (let col = loop.column.start; col <= loop.column.end; col++) {\n        const cell = this.cells[row][col];\n        cells.push(cell);\n        cellNames.push(cell.getName());\n      }\n    }\n    return { cells, cellNames };\n  }\n\n  cellIsHighlighted(name, highlightedAreas) {\n    return !!highlightedAreas.find(a => a.cellNames.includes(name));\n  }\n\n  updateCell(name, formula) {\n    this.findCell(name).setFormula(formula);\n  }\n\n  updateCells(cellNames, formula) {\n    cellNames.forEach(name => this.updateCell(name, formula));\n  }\n\n  createCells(rowCount, columnCount) {\n    let rows = [];\n    for (let i = 0; i < rowCount; i++) {\n      rows[i] = [];\n      for (let j = 0; j < columnCount; j++) {\n        const cell = new Cell({ sheet: this, formula: '', value: '' });\n        rows[i][j] = cell;\n        this.cellNames.set(cell, indexToCell(i, j));\n      }\n    }\n    return rows;\n  }\n\n  getCellName(cell) {\n    return this.cellNames.get(cell);\n  }\n\n  size() {\n    return { rows: this.rows(), columns: this.columns() };\n  }\n\n  rows() {\n    return this.cells.length;\n  }\n\n  columns() {\n    return this.cells[0].length;\n  }\n\n  nextRow(cellName) {\n    const cell = cellToIndex(cellName);\n    const nextRow = cell.row === this.rows() - 1 ? 0 : cell.row + 1;\n    return indexToCell(nextRow, cell.column);\n  }\n\n  nextColumn(cellName) {\n    const cell = cellToIndex(cellName);\n    const nextColumn = cell.column === this.columns() - 1 ? 0 : cell.column + 1;\n    return indexToCell(cell.row, nextColumn);\n  }\n\n  previousRow(cellName) {\n    const cell = cellToIndex(cellName);\n    const previousRow = cell.row === 0 ? this.rows() - 1 : cell.row - 1;\n    return indexToCell(previousRow, cell.column);\n  }\n\n  previousColumn(cellName) {\n    const cell = cellToIndex(cellName);\n    const previousColumn =\n      cell.column === 0 ? this.columns() - 1 : cell.column - 1;\n    return indexToCell(cell.row, previousColumn);\n  }\n}\n\nexport default Sheet;\n","import { combineReducers } from 'redux';\nimport sheetReducer from './sheetReducer';\n\nexport default combineReducers({\n  sheet: sheetReducer,\n});\n","import { createStore, applyMiddleware, compose } from 'redux';\nimport reduxThunk from 'redux-thunk';\nimport reducers from './reducers';\n\nconst composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose;\nconst store = createStore(\n  reducers,\n  composeEnhancers(applyMiddleware(reduxThunk))\n);\n\nexport default store;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Provider } from 'react-redux';\n\nimport App from './components/App';\nimport store from './store';\n\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  document.querySelector('#root')\n);\n"],"sourceRoot":""}