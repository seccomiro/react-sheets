(this["webpackJsonpreact-sheets"]=this["webpackJsonpreact-sheets"]||[]).push([[0],{42:function(e,t,l){e.exports=l(56)},56:function(e,t,l){"use strict";l.r(t);var n,a=l(0),r=l.n(a),o=l(21),c=l.n(o),u=l(12),s=l(35),i=l(16),m=l(8),h=l(9),p=l(13),d=l(14),f=function(e,t){return{type:"UPDATE_CELL",payload:{cellName:e,formula:t}}},v=function(e){return{type:"UPDATE_EDITING_CELL",payload:e}},E=function(e,t){return{type:"SELECT_CELL",payload:{name:e,selected:t}}},C=function(){return{type:"NEXT_ROW"}},y=function(){return{type:"NEXT_COLUMN"}},g=function(){return{type:"PREVIOUS_ROW"}},w=function(){return{type:"PREVIOUS_COLUMN"}},b=function(e){Object(d.a)(l,e);var t=Object(p.a)(l);function l(){var e;Object(m.a)(this,l);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.props.updateEditingCell(t.target.value)},e.onKeyDown=function(t){9===t.which?e.nextElement("Column",t,!1,!0):13===t.which?e.nextElement("Row",t,!1,!0):27===t.which&&e.props.selectCell(e.props.name,!0)},e.nextElement=function(t,l){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];l.preventDefault();var r=n?"previous":"next";a&&e.props.updateCell(e.props.name,l.target.value),e.props["".concat(r).concat(t)]()},e.onFocus=function(){e.props.atFormulaBar&&e.props.selectFormulaBar(!0)},e.onBlur=function(t){e.props.atFormulaBar&&e.props.selectFormulaBar(!1),e.props.updateCell(e.props.name,t.target.value)},e}return Object(h.a)(l,[{key:"render",value:function(){return r.a.createElement("input",{onFocus:this.onFocus,onBlur:this.onBlur,onKeyDown:this.onKeyDown,onChange:this.onChange,type:"text",value:this.props.formula,autoFocus:!this.props.formulaBarSelected})}}]),l}(a.Component),O=Object(u.b)((function(e){return{formula:e.sheet.selectedCell.tempFormula,name:e.sheet.selectedCell.name,formulaBarSelected:e.sheet.selectedCell.formulaBarSelected}}),{updateEditingCell:v,updateCell:f,nextColumn:y,nextRow:C,previousColumn:w,previousRow:g,selectFormulaBar:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return{type:"SELECT_FORMULA_BAR",payload:{entering:e}}},selectCell:E})(b),N=function(e){Object(d.a)(l,e);var t=Object(p.a)(l);function l(){var e;Object(m.a)(this,l);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).focusSelecTed=function(){e.field&&!e.props.selectedCell.formulaBarSelected&&e.field.focus()},e.onEditCell=function(t){e.props.editCell(e.props.name,!0)},e.onSelectCell=function(t){e.props.selectCell(e.props.name,!0)},e.onEditingKeyDown=function(t){13===t.which?e.nextElement("Row",t,!1,!0):37===t.which?e.nextElement("Column",t,!0,!0):38===t.which?e.nextElement("Row",t,!0,!0):39===t.which?e.nextElement("Column",t,!1,!0):40===t.which&&e.nextElement("Row",t,!1,!0)},e.onSelectedKeyDown=function(t){113===t.which||13===t.which?(t.preventDefault(),e.props.editCell(e.props.name,!0)):9===t.which?e.nextElement("Column",t):37===t.which?e.nextElement("Column",t,!0):38===t.which?e.nextElement("Row",t,!0):39===t.which?e.nextElement("Column",t):40===t.which?e.nextElement("Row",t):e.printableKey(t.which)&&(t.preventDefault(),e.props.editCell(e.props.name,!0,e.printableKey(t.which)))},e.nextElement=function(t,l){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];l.preventDefault();var r=n?"previous":"next";a&&e.props.updateCell(e.props.name,l.target.value),e.props["".concat(r).concat(t)]()},e}return Object(h.a)(l,[{key:"componentDidMount",value:function(){this.focusSelecTed()}},{key:"componentDidUpdate",value:function(){this.focusSelecTed()}},{key:"printableKey",value:function(e){return e>=48&&e<=90?String.fromCharCode(e):e>=96&&e<=105?String.fromCharCode(e-48):187===e&&"="}},{key:"render",value:function(){var e=this;return this.props.selected?this.props.editing?r.a.createElement("div",{className:"cell selected"},r.a.createElement(O,{onKeyDown:this.onEditingKeyDown})):r.a.createElement("div",{ref:function(t){return e.field=t},className:"cell selected",onClick:this.onSelectCell,onDoubleClick:this.onEditCell,onKeyDown:this.onSelectedKeyDown,tabIndex:"0"},r.a.createElement("div",null,this.props.cell.value||"\xa0")):r.a.createElement("div",{className:"cell",onClick:this.onSelectCell,onDoubleClick:this.onEditCell},r.a.createElement("div",null,this.props.cell.value||"\xa0"))}}]),l}(r.a.Component),k=(n=Object(u.b)((function(e,t){var l=e.sheet.sheet.findCell(t.name);return{selectedCell:e.sheet.selectedCell,cell:l}}),{updateCell:f,updateEditingCell:v,editCell:function(e,t,l){return{type:"EDIT_CELL",payload:{name:e,selected:t,value:l}}},selectCell:E,nextColumn:y,nextRow:C,previousColumn:w,previousRow:g})(N),function(e){Object(d.a)(l,e);var t=Object(p.a)(l);function l(){return Object(m.a)(this,l),t.apply(this,arguments)}return Object(h.a)(l,[{key:"showSquare",value:function(){if(this.props.selected&&!this.props.editing)return r.a.createElement("div",{className:"cell-square"})}},{key:"render",value:function(){return r.a.createElement("td",{className:this.props.selected?"selected":""},r.a.createElement("div",{className:"cell-wrapper"},r.a.createElement(n,Object.assign({},this.props,{selected:this.props.selected,editing:this.props.editing})),this.showSquare()))}}]),l}(a.Component)),S=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],j=function(e){return S[e]},_=function(e){return e+1},x=function(e,t){return"".concat(j(t)).concat(_(e))},D=function(e){return{row:(l=e[1],parseInt(l)-1),column:(t=e[0],S.indexOf(t.toUpperCase()))};var t,l},L=l(33),R=l(34),T=function(){return r.a.createElement("div",{className:"formula-bar"},r.a.createElement("div",{className:"icon"},r.a.createElement(L.a,{icon:R.a})),r.a.createElement(O,{atFormulaBar:!0}))},F=function(e){Object(d.a)(l,e);var t=Object(p.a)(l);function l(){return Object(m.a)(this,l),t.apply(this,arguments)}return Object(h.a)(l,[{key:"renderCells",value:function(){var e=this;return r.a.createElement("div",{className:"sheet"},r.a.createElement(T,null),r.a.createElement("table",{className:"sheet-table"},r.a.createElement("thead",{style:{textAlign:"right"}},r.a.createElement("tr",null,r.a.createElement("th",{className:"column-header"}),this.props.cells[0].map((function(t,l){var n,a,o;return r.a.createElement("th",{key:"c".concat(l),className:"column-header ".concat((a=null===(n=e.props.selectedCell)||void 0===n?void 0:n.name,o=t.getName(),a&&o&&D(a).column===D(o).column?"selected":""))},r.a.createElement("div",null,j(l)))})))),r.a.createElement("tbody",null,this.props.cells.map((function(t,l){return r.a.createElement("tr",{key:l},t.map((function(t,n){var o,c,u,s,i;return r.a.createElement(a.Fragment,{key:n},0===n?r.a.createElement("th",{className:"row-header ".concat((s=null===(o=e.props.selectedCell)||void 0===o?void 0:o.name,i=t.getName(),s&&i&&D(s).row===D(i).row?"selected":""))},r.a.createElement("div",null,_(l))):r.a.createElement(r.a.Fragment,null),r.a.createElement(k,{name:t.getName(),selected:(null===(c=e.props.selectedCell)||void 0===c?void 0:c.name)===t.getName(),editing:(null===(u=e.props.selectedCell)||void 0===u?void 0:u.name)===t.getName()&&e.props.selectedCell.editing}))})))})))))}},{key:"render",value:function(){return r.a.createElement("div",null,this.renderCells())}}]),l}(r.a.Component),B=Object(u.b)((function(e){return{cells:e.sheet.sheet.cells,selectedCell:e.sheet.selectedCell}}),{})(F),U=l(6),A=Object(U.a)(),I=function(){return r.a.createElement("div",{className:"help"},r.a.createElement("p",null,"This app is a work in progress by"," ",r.a.createElement("a",{href:"https://www.linkedin.com/in/diegostiehl",rel:"noopener noreferrer",target:"_blank"},"Diego Stiehl"),". You can see its code here:"," ",r.a.createElement("a",{href:"https://github.com/seccomiro/react-sheets",rel:"noopener noreferrer",target:"_blank"},"https://github.com/seccomiro/react-sheets"),"."),r.a.createElement("p",null,"At this point in time you can:"),r.a.createElement("ul",null,r.a.createElement("li",null,"Navigate through cells (enabling editing of them) using ",r.a.createElement("em",null,"TAB"),","," ",r.a.createElement("em",null,"ENTER"),", ",r.a.createElement("em",null,"arrows")," or ",r.a.createElement("em",null,"mouse"),"."),r.a.createElement("li",null,"Edit cells using ",r.a.createElement("em",null,"F2"),", ",r.a.createElement("em",null,"ENTER")," or by clicking at the ",r.a.createElement("em",null,"Formula Bar"),"."),r.a.createElement("li",null,"Cancel editing using ",r.a.createElement("em",null,"ESC"),"."),r.a.createElement("li",null,"Type ",r.a.createElement("em",null,"numeric")," values, like ",r.a.createElement("em",null,"10")," or ",r.a.createElement("em",null,"99.56")," at any available cell."),r.a.createElement("li",null,"Type simple math formulas using the cells, like:"," ",r.a.createElement("em",null,"=A1+(B2/C3)*D5-10")," (try to avoid circular references because it's not solved yet)."),r.a.createElement("li",null,"Edit the values of cells yout pointed on any formula and watch the"," ",r.a.createElement("em",null,"automatic recalculation")," of the entire spreadsheet.",r.a.createElement("ul",null,r.a.createElement("li",null,"Tip: Try to write a formula that depends on two cells that have formulas that depends on other cells that have regular numbers and, after that, change these regular numbers.")))))},K=function(){return r.a.createElement("div",null,r.a.createElement(s.a,{history:A,basename:"/react-sheets"},r.a.createElement(i.c,null,r.a.createElement(i.a,{path:"/",exact:!0,component:B}))),r.a.createElement(I,null))},M=l(15),P=l(37),X=l(10),V=l(29),W=l.n(V),q=l(40),G=l(58),J=/([+,*,/,=,\-,(,)])/g,Y=function(e){return!$(e)&&""!==e&&"="!==e&&!e.match(J)},$=function(e){return!isNaN(e)},z=function(){function e(t){var l=t.sheet,n=t.formula,a=void 0===n?"0":n,r=t.value,o=void 0===r?"0":r;Object(m.a)(this,e),this.sheet=l,this.formula=a,this.value=o,this.listeners=new Set,this.pointedCells={}}return Object(h.a)(e,[{key:"setFormula",value:function(e){this.formula=e;var t=function(e){var t=e.split(J).filter((function(e){return Y(e.trim())}));return Object(q.a)(new Set(t))}(e);this.pointedCells=this.sheet.register(this,t),this.evaluate()}},{key:"registerListener",value:function(e){this.listeners.add(e)}},{key:"getName",value:function(){return this.sheet.getCellName(this)}},{key:"evaluate",value:function(){var e,t;this.formula.startsWith("=")?this.value=(e=this.formula.substring(1,this.formula.length),t=this.pointedCellParams(),Object(G.a)(e,t)):this.value=this.formula,this.listeners.forEach((function(e){return e.evaluate()}))}},{key:"pointedCellParams",value:function(){var e=this,t={};return Object.keys(this.pointedCells).forEach((function(l){return t[l]=e.pointedCells[l].value})),t}}]),e}(),H={sheet:new(function(){function e(t){var l=t.rows,n=t.columns,a=t.name;Object(m.a)(this,e),this.cellNames=new Map,this.cells=this.createCells(l,n),this.name=a}return Object(h.a)(e,[{key:"register",value:function(e,t){var l=this;return t.map((function(e){return l.findCell(e)})).forEach((function(t){return t.registerListener(e)})),this.cellMap(t)}},{key:"cellMap",value:function(e){var t=this,l={};return e.forEach((function(e){var n=t.findCell(e);l[e]=n})),l}},{key:"findCell",value:function(e){var t=D(e);return this.cells[t.row][t.column]}},{key:"updateCell",value:function(e,t){this.findCell(e).setFormula(t)}},{key:"createCells",value:function(e,t){for(var l=[],n=0;n<e;n++){l[n]=[];for(var a=0;a<t;a++){var r=new z({sheet:this,formula:"",value:""});l[n][a]=r,this.cellNames.set(r,x(n,a))}}return l}},{key:"getCellName",value:function(e){return this.cellNames.get(e)}},{key:"size",value:function(){return{rows:this.rows(),columns:this.columns()}}},{key:"rows",value:function(){return this.cells.length}},{key:"columns",value:function(){return this.cells[0].length}},{key:"nextRow",value:function(e){var t=D(e),l=t.row===this.rows()-1?0:t.row+1;return x(l,t.column)}},{key:"nextColumn",value:function(e){var t=D(e),l=t.column===this.columns()-1?0:t.column+1;return x(t.row,l)}},{key:"previousRow",value:function(e){var t=D(e),l=0===t.row?this.rows()-1:t.row-1;return x(l,t.column)}},{key:"previousColumn",value:function(e){var t=D(e),l=0===t.column?this.columns()-1:t.column-1;return x(t.row,l)}}]),e}())({rows:9,columns:26,name:"Sheet 1"}),selectedCell:{name:"A1",editing:!1,tempFormula:"",formulaBarSelected:!1}},Q=Object(M.c)({sheet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:H,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_EDITING_CELL":return W()(e,{selectedCell:{tempFormula:{$set:t.payload.toUpperCase()}}});case"UPDATE_CELL":var l=t.payload,n=l.cellName,a=l.formula;return e.sheet.updateCell(n,a),e;case"SELECT_CELL":return Object(X.a)({},e,{selectedCell:t.payload.selected?{name:t.payload.name,tempFormula:e.sheet.findCell(t.payload.name).formula,editing:!1,formulaBarSelected:!1}:void 0});case"EDIT_CELL":return Object(X.a)({},e,{selectedCell:t.payload.selected?{name:t.payload.name,tempFormula:t.payload.value||e.sheet.findCell(t.payload.name).formula,editing:!0,formulaBarSelected:!1}:void 0});case"SELECT_FORMULA_BAR":return W()(e,{selectedCell:{formulaBarSelected:{$set:t.payload.entering}}});case"NEXT_COLUMN":var r=e.sheet.nextColumn(e.selectedCell.name),o=e.sheet.findCell(r).formula;return Object(X.a)({},e,{selectedCell:Object(X.a)({},e.selectedCell,{name:r,tempFormula:o,editing:!1,formulaBarSelected:!1})});case"NEXT_ROW":var c=e.sheet.nextRow(e.selectedCell.name),u=e.sheet.findCell(c).formula;return Object(X.a)({},e,{selectedCell:Object(X.a)({},e.selectedCell,{name:c,tempFormula:u,editing:!1,formulaBarSelected:!1})});case"PREVIOUS_COLUMN":var s=e.sheet.previousColumn(e.selectedCell.name),i=e.sheet.findCell(s).formula;return Object(X.a)({},e,{selectedCell:Object(X.a)({},e.selectedCell,{name:s,tempFormula:i,editing:!1,formulaBarSelected:!1})});case"PREVIOUS_ROW":var m=e.sheet.previousRow(e.selectedCell.name),h=e.sheet.findCell(m).formula;return Object(X.a)({},e,{selectedCell:Object(X.a)({},e.selectedCell,{name:m,tempFormula:h,editing:!1,formulaBarSelected:!1})});default:return e}}}),Z=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||M.d,ee=Object(M.e)(Q,Z(Object(M.a)(P.a)));c.a.render(r.a.createElement(u.a,{store:ee},r.a.createElement(K,null)),document.querySelector("#root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.7dd0e7a9.chunk.js.map