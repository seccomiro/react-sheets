(this["webpackJsonpreact-sheets"]=this["webpackJsonpreact-sheets"]||[]).push([[0],{39:function(e,t,l){e.exports=l(50)},50:function(e,t,l){"use strict";l.r(t);var n=l(0),a=l.n(n),r=l(18),c=l.n(r),s=l(15),u=l(31),o=l(11),i=l(8),m=l(9),h=l(20),p=l(21),d=function(e){Object(p.a)(l,e);var t=Object(h.a)(l);function l(){var e;Object(i.a)(this,l);for(var n=arguments.length,a=new Array(n),r=0;r<n;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.props.updateEditingCell(t.target.value)},e.onSelectCell=function(t){e.props.selectCell(e.props.name,!0)},e.onKeyDown=function(t){9===t.which?e.nextElement("Column",t):13===t.which&&e.nextElement("Row",t)},e.nextElement=function(t,l){l.preventDefault(),e.props.updateCell(e.props.name,l.target.value),e.props["next".concat(t)]()},e.onBlur=function(t){e.props.updateCell(e.props.name,t.target.value)},e}return Object(m.a)(l,[{key:"render",value:function(){return this.props.selectedCell&&this.props.selectedCell.name===this.props.name?a.a.createElement("div",{className:"cell selected"},a.a.createElement("input",{className:"test",onKeyDown:this.onKeyDown,onChange:this.onChange,onFocus:function(e){return e.target.select()},onBlur:this.onBlur,type:"text",value:this.props.selectedCell.tempFormula,autoFocus:!0})):a.a.createElement("div",{className:"cell",onClick:this.onSelectCell},a.a.createElement("div",{className:"test"},this.props.cell.value||"\xa0"))}}]),l}(a.a.Component),f=Object(s.b)((function(e,t){var l=e.sheet.sheet.findCell(t.name);return{selectedCell:e.sheet.selectedCell,cell:l}}),{updateCell:function(e,t){return{type:"UPDATE_CELL",payload:{cellName:e,formula:t}}},updateEditingCell:function(e){return{type:"UPDATE_EDITING_CELL",payload:e}},selectCell:function(e,t){return{type:"SELECT_CELL",payload:{name:e,selected:t}}},nextColumn:function(){return{type:"NEXT_COLUMN"}},nextRow:function(){return{type:"NEXT_ROW"}}})(d),v=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],E=function(e){return v[e]},C=function(e){return e+1},y=function(e,t){return"".concat(E(t)).concat(C(e))},g=function(e){return{row:(l=e[1],parseInt(l)-1),column:(t=e[0],v.indexOf(t.toUpperCase()))};var t,l},b=function(e){Object(p.a)(l,e);var t=Object(h.a)(l);function l(){return Object(i.a)(this,l),t.apply(this,arguments)}return Object(m.a)(l,[{key:"renderCells",value:function(){var e=this;return a.a.createElement("table",{className:"sheet-table"},a.a.createElement("thead",{style:{textAlign:"right"}},a.a.createElement("tr",null,a.a.createElement("th",{className:"column-header"}),this.props.cells[0].map((function(t,l){var n,r,c;return a.a.createElement("th",{key:"c".concat(l),className:"column-header ".concat((r=null===(n=e.props.selectedCell)||void 0===n?void 0:n.name,c=t.getName(),r&&c&&g(r).column===g(c).column?"selected":""))},a.a.createElement("div",null,E(l)))})))),a.a.createElement("tbody",null,this.props.cells.map((function(t,l){return a.a.createElement("tr",{key:l},t.map((function(t,r){var c,s,u,o;return a.a.createElement(n.Fragment,{key:r},0===r?a.a.createElement("th",{className:"row-header ".concat((u=null===(c=e.props.selectedCell)||void 0===c?void 0:c.name,o=t.getName(),u&&o&&g(u).row===g(o).row?"selected":""))},a.a.createElement("div",null,C(l))):a.a.createElement(a.a.Fragment,null),a.a.createElement("td",{className:(null===(s=e.props.selectedCell)||void 0===s?void 0:s.name)===t.getName()?"selected":""},a.a.createElement(f,{name:t.getName()})))})))}))))}},{key:"render",value:function(){return a.a.createElement("div",null,this.renderCells())}}]),l}(a.a.Component),w=Object(s.b)((function(e){return{cells:e.sheet.sheet.cells,selectedCell:e.sheet.selectedCell}}),{})(b),N=l(5),O=Object(N.a)(),k=function(){return a.a.createElement("div",{className:"help"},a.a.createElement("p",null,"This app is a work in progress by"," ",a.a.createElement("a",{href:"https://www.linkedin.com/in/diegostiehl",rel:"noopener noreferrer",target:"_blank"},"Diego Stiehl"),". You can see its code here:"," ",a.a.createElement("a",{href:"https://github.com/seccomiro/react-sheets",rel:"noopener noreferrer",target:"_blank"},"https://github.com/seccomiro/react-sheets"),"."),a.a.createElement("p",null,"At this point in time you can:"),a.a.createElement("ul",null,a.a.createElement("li",null,"Navigate through cells (enabling editing of them) using ",a.a.createElement("em",null,"TAB"),","," ",a.a.createElement("em",null,"ENTER")," and ",a.a.createElement("em",null,"mouse"),"."),a.a.createElement("li",null,"Type numeric values, like ",a.a.createElement("em",null,"10")," or ",a.a.createElement("em",null,"99.56")," at any available cell."),a.a.createElement("li",null,"Type simple math formulas using the cells, like:"," ",a.a.createElement("em",null,"=A1+(B2/C3)*D5-10")," (try to avoid circular references because it's not solved yet)."),a.a.createElement("li",null,"Edit the values of cells yout pointed on any formula and watch the"," ",a.a.createElement("em",null,"automatic recalculation")," of the entire spreadsheet.",a.a.createElement("ul",null,a.a.createElement("li",null,"Tip: Try to write a formula that depends on two cells that have formulas that depends on other cells that have regular numbers asnd, after that, change these regular numbers.")))))},j=function(){return a.a.createElement("div",null,a.a.createElement(u.a,{history:O,basename:"/react-sheets"},a.a.createElement(o.c,null,a.a.createElement(o.a,{path:"/",exact:!0,component:w}))),a.a.createElement(k,null))},T=l(10),_=l(33),L=l(16),x=l(34),D=l.n(x),S=l(37),F=l(52),A=/([+,*,/,=,\-,(,)])/g,U=function(e){return!R(e)&&""!==e&&"="!==e&&!e.match(A)},R=function(e){return!isNaN(e)},P=function(){function e(t){var l=t.sheet,n=t.formula,a=void 0===n?"0":n,r=t.value,c=void 0===r?"0":r;Object(i.a)(this,e),this.sheet=l,this.formula=a,this.value=c,this.listeners=new Set,this.pointedCells={}}return Object(m.a)(e,[{key:"setFormula",value:function(e){this.formula=e;var t=function(e){var t=e.split(A).filter((function(e){return U(e.trim())}));return Object(S.a)(new Set(t))}(e);this.pointedCells=this.sheet.register(this,t),this.evaluate()}},{key:"registerListener",value:function(e){this.listeners.add(e)}},{key:"getName",value:function(){return this.sheet.getCellName(this)}},{key:"evaluate",value:function(){var e,t;this.formula.startsWith("=")?this.value=(e=this.formula.substring(1,this.formula.length),t=this.pointedCellParams(),Object(F.a)(e,t)):this.value=this.formula,this.listeners.forEach((function(e){return e.evaluate()}))}},{key:"pointedCellParams",value:function(){var e=this,t={};return Object.keys(this.pointedCells).forEach((function(l){return t[l]=e.pointedCells[l].value})),t}}]),e}(),I={sheet:new(function(){function e(t){var l=t.rows,n=t.columns,a=t.name;Object(i.a)(this,e),this.cellNames=new Map,this.cells=this.createCells(l,n),this.name=a}return Object(m.a)(e,[{key:"register",value:function(e,t){var l=this;return t.map((function(e){return l.findCell(e)})).forEach((function(t){return t.registerListener(e)})),this.cellMap(t)}},{key:"cellMap",value:function(e){var t=this,l={};return e.forEach((function(e){var n=t.findCell(e);l[e]=n})),l}},{key:"findCell",value:function(e){var t=g(e);return this.cells[t.row][t.column]}},{key:"updateCell",value:function(e,t){this.findCell(e).setFormula(t)}},{key:"createCells",value:function(e,t){for(var l=[],n=0;n<e;n++){l[n]=[];for(var a=0;a<t;a++){var r=new P({sheet:this,formula:"",value:""});l[n][a]=r,this.cellNames.set(r,y(n,a))}}return l}},{key:"getCellName",value:function(e){return this.cellNames.get(e)}},{key:"size",value:function(){return{rows:this.rows(),columns:this.columns()}}},{key:"rows",value:function(){return this.cells.length}},{key:"columns",value:function(){return this.cells[0].length}},{key:"nextRow",value:function(e){var t=g(e),l=t.row===this.rows()-1?0:t.row+1;return y(l,t.column)}},{key:"nextColumn",value:function(e){var t=g(e),l=t.column===this.columns()-1?0:t.column+1;return y(t.row,l)}}]),e}())({rows:9,columns:26,name:"Sheet 1"}),selectedCell:void 0},M=Object(T.c)({sheet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_EDITING_CELL":return D()(e,{selectedCell:{tempFormula:{$set:t.payload.toUpperCase()}}});case"UPDATE_CELL":var l=t.payload,n=l.cellName,a=l.formula;return e.sheet.updateCell(n,a),e;case"SELECT_CELL":return Object(L.a)({},e,{selectedCell:t.payload.selected?{name:t.payload.name,tempFormula:e.sheet.findCell(t.payload.name).formula}:void 0});case"NEXT_COLUMN":var r=e.sheet.nextColumn(e.selectedCell.name),c=e.sheet.findCell(r).formula;return Object(L.a)({},e,{selectedCell:Object(L.a)({},e.selectedCell,{name:r,tempFormula:c})});case"NEXT_ROW":var s=e.sheet.nextRow(e.selectedCell.name),u=e.sheet.findCell(s).formula;return Object(L.a)({},e,{selectedCell:Object(L.a)({},e.selectedCell,{name:s,tempFormula:u})});default:return e}}}),X=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||T.d,B=Object(T.e)(M,X(Object(T.a)(_.a)));c.a.render(a.a.createElement(s.a,{store:B},a.a.createElement(j,null)),document.querySelector("#root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.8d40d417.chunk.js.map