(this["webpackJsonpreact-sheets"]=this["webpackJsonpreact-sheets"]||[]).push([[0],{39:function(e,t,n){e.exports=n(50)},50:function(e,t,n){"use strict";n.r(t);var l=n(0),a=n.n(l),r=n(18),s=n.n(r),c=n(15),u=n(31),o=n(11),i=n(8),m=n(9),h=n(20),p=n(21),d=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){var e;Object(i.a)(this,n);for(var l=arguments.length,a=new Array(l),r=0;r<l;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).onChange=function(t){e.props.updateEditingCell(t.target.value)},e.onSelectCell=function(t){e.props.selectCell(e.props.name,!0)},e.onKeyDown=function(t){9===t.which?e.nextElement("Column",t):13===t.which&&e.nextElement("Row",t)},e.nextElement=function(t,n){n.preventDefault(),e.props.updateCell(e.props.name,n.target.value),e.props["next".concat(t)]()},e.onBlur=function(t){e.props.updateCell(e.props.name,t.target.value)},e}return Object(m.a)(n,[{key:"render",value:function(){return this.props.selectedCell&&this.props.selectedCell.name===this.props.name?a.a.createElement("div",{className:"cell selected"},a.a.createElement("input",{className:"test",onKeyDown:this.onKeyDown,onChange:this.onChange,onFocus:function(e){return e.target.select()},onBlur:this.onBlur,type:"text",value:this.props.selectedCell.tempFormula,autoFocus:!0})):a.a.createElement("div",{className:"cell",onClick:this.onSelectCell},a.a.createElement("div",{className:"test"},this.props.cell.value||"\xa0"))}}]),n}(a.a.Component),f=Object(c.b)((function(e,t){var n=e.sheet.sheet.findCell(t.name);return{selectedCell:e.sheet.selectedCell,cell:n}}),{updateCell:function(e,t){return{type:"UPDATE_CELL",payload:{cellName:e,formula:t}}},updateEditingCell:function(e){return{type:"UPDATE_EDITING_CELL",payload:e}},selectCell:function(e,t){return{type:"SELECT_CELL",payload:{name:e,selected:t}}},nextColumn:function(){return{type:"NEXT_COLUMN"}},nextRow:function(){return{type:"NEXT_ROW"}}})(d),v=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],C=function(e){return v[e]},E=function(e){return e+1},y=function(e,t){return"".concat(C(t)).concat(E(e))},O=function(e){return{row:(n=e[1],parseInt(n)-1),column:(t=e[0],v.indexOf(t.toUpperCase()))};var t,n},b=function(e){Object(p.a)(n,e);var t=Object(h.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(m.a)(n,[{key:"renderCells",value:function(){var e=this;return a.a.createElement("table",{className:"sheet-table"},a.a.createElement("thead",{style:{textAlign:"right"}},a.a.createElement("tr",null,a.a.createElement("th",{className:"column-header"}),this.props.cells[0].map((function(t,n){var l,r,s;return a.a.createElement("th",{key:"c".concat(n),className:"column-header ".concat((r=null===(l=e.props.selectedCell)||void 0===l?void 0:l.name,s=t.getName(),r&&s&&O(r).column===O(s).column?"selected":""))},a.a.createElement("div",null,C(n)))})))),a.a.createElement("tbody",null,this.props.cells.map((function(t,n){return a.a.createElement("tr",{key:n},t.map((function(t,r){var s,c,u,o;return a.a.createElement(l.Fragment,{key:r},0===r?a.a.createElement("th",{className:"row-header ".concat((u=null===(s=e.props.selectedCell)||void 0===s?void 0:s.name,o=t.getName(),u&&o&&O(u).row===O(o).row?"selected":""))},a.a.createElement("div",null,E(n))):a.a.createElement(a.a.Fragment,null),a.a.createElement("td",{className:(null===(c=e.props.selectedCell)||void 0===c?void 0:c.name)===t.getName()?"selected":""},a.a.createElement(f,{name:t.getName()})))})))}))))}},{key:"render",value:function(){return a.a.createElement("div",null,this.renderCells())}}]),n}(a.a.Component),w=Object(c.b)((function(e){return{cells:e.sheet.sheet.cells,selectedCell:e.sheet.selectedCell}}),{})(b),N=n(5),g=Object(N.a)(),j=function(){return a.a.createElement("div",null,a.a.createElement(u.a,{history:g,basename:"/react-sheets"},a.a.createElement(o.c,null,a.a.createElement(o.a,{path:"/",exact:!0,component:w}))))},k=n(10),L=n(33),_=n(16),x=n(34),T=n.n(x),D=n(37),F=n(52),S=/([+,*,/,=,\-,(,)])/g,U=function(e){return!P(e)&&""!==e&&"="!==e&&!e.match(S)},P=function(e){return!isNaN(e)},R=function(){function e(t){var n=t.sheet,l=t.formula,a=void 0===l?"0":l,r=t.value,s=void 0===r?"0":r;Object(i.a)(this,e),this.sheet=n,this.formula=a,this.value=s,this.listeners=new Set,this.pointedCells={}}return Object(m.a)(e,[{key:"setFormula",value:function(e){this.formula=e;var t=function(e){var t=e.split(S).filter((function(e){return U(e.trim())}));return Object(D.a)(new Set(t))}(e);this.pointedCells=this.sheet.register(this,t),this.evaluate()}},{key:"registerListener",value:function(e){this.listeners.add(e)}},{key:"getName",value:function(){return this.sheet.getCellName(this)}},{key:"evaluate",value:function(){var e,t;this.formula.startsWith("=")?this.value=(e=this.formula.substring(1,this.formula.length),t=this.pointedCellParams(),Object(F.a)(e,t)):this.value=this.formula,this.listeners.forEach((function(e){return e.evaluate()}))}},{key:"pointedCellParams",value:function(){var e=this,t={};return Object.keys(this.pointedCells).forEach((function(n){return t[n]=e.pointedCells[n].value})),t}}]),e}(),A={sheet:new(function(){function e(t){var n=t.rows,l=t.columns,a=t.name;Object(i.a)(this,e),this.cellNames=new Map,this.cells=this.createCells(n,l),this.name=a}return Object(m.a)(e,[{key:"register",value:function(e,t){var n=this;return t.map((function(e){return n.findCell(e)})).forEach((function(t){return t.registerListener(e)})),this.cellMap(t)}},{key:"cellMap",value:function(e){var t=this,n={};return e.forEach((function(e){var l=t.findCell(e);n[e]=l})),n}},{key:"findCell",value:function(e){var t=O(e);return this.cells[t.row][t.column]}},{key:"updateCell",value:function(e,t){this.findCell(e).setFormula(t)}},{key:"createCells",value:function(e,t){for(var n=[],l=0;l<e;l++){n[l]=[];for(var a=0;a<t;a++){var r=new R({sheet:this,formula:"",value:""});n[l][a]=r,this.cellNames.set(r,y(l,a))}}return n}},{key:"getCellName",value:function(e){return this.cellNames.get(e)}},{key:"size",value:function(){return{rows:this.rows(),columns:this.columns()}}},{key:"rows",value:function(){return this.cells.length}},{key:"columns",value:function(){return this.cells[0].length}},{key:"nextRow",value:function(e){var t=O(e),n=t.row===this.rows()-1?0:t.row+1;return y(n,t.column)}},{key:"nextColumn",value:function(e){var t=O(e),n=t.column===this.columns()-1?0:t.column+1;return y(t.row,n)}}]),e}())({rows:9,columns:26,name:"Sheet 1"}),selectedCell:void 0},I=Object(k.c)({sheet:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:A,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"UPDATE_EDITING_CELL":return T()(e,{selectedCell:{tempFormula:{$set:t.payload.toUpperCase()}}});case"UPDATE_CELL":var n=t.payload,l=n.cellName,a=n.formula;return e.sheet.updateCell(l,a),e;case"SELECT_CELL":return Object(_.a)({},e,{selectedCell:t.payload.selected?{name:t.payload.name,tempFormula:e.sheet.findCell(t.payload.name).formula}:void 0});case"NEXT_COLUMN":var r=e.sheet.nextColumn(e.selectedCell.name),s=e.sheet.findCell(r).formula;return Object(_.a)({},e,{selectedCell:Object(_.a)({},e.selectedCell,{name:r,tempFormula:s})});case"NEXT_ROW":var c=e.sheet.nextRow(e.selectedCell.name),u=e.sheet.findCell(c).formula;return Object(_.a)({},e,{selectedCell:Object(_.a)({},e.selectedCell,{name:c,tempFormula:u})});default:return e}}}),M=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||k.d,X=Object(k.e)(I,M(Object(k.a)(L.a)));s.a.render(a.a.createElement(c.a,{store:X},a.a.createElement(j,null)),document.querySelector("#root"))}},[[39,1,2]]]);
//# sourceMappingURL=main.e619b57f.chunk.js.map